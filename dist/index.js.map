{"version":3,"sourceRoot":"/source_map/","sources":["src/index.ts"],"names":[],"mappings":"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","sourcesContent":["import {html, css, LitElement} from 'lit';\nimport {customElement, property} from 'lit/decorators.js';\nimport santa from './santaURI';\nimport './santa-present';\nimport { SantaPresent } from './santa-present';\nexport { SantaPresent };\n\nfunction rangeMap(number, inMin, inMax, outMin, outMax) {\n  return ((number - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin;\n}\n\n@customElement('flying-santa')\nexport class FlyingSanta extends LitElement {\n  static get styles() {\n    return css`\n      :host {\n        position: absolute;\n        display: block;\n        --scale-x: 1;\n        --santa-rotate: 10deg;\n        z-index: 999999;\n        transform: rotate(var(--santa-rotate));\n      }\n\n      :host([x-direction=\"left\"]) {\n        --scale-x: -1;\n        transform: rotate(calc(var(--santa-rotate) * -1));\n      }\n\n      img {\n        width: 250px;\n        transform: scaleX(var(--scale-x));\n      }\n    `;\n  }\n\n  @property({ type: 'String', reflect: true, attribute: 'x-direction' })\n  xDirection = 'right';\n\n  @property({ type: 'Number', reflect: true, attribute: 'change-speed' })\n  changeSpeed = 5000;\n\n  @property({ type: 'Number', reflect: true })\n  speed = 1;\n\n  @property({ type: 'Number', reflect: true, attribute: 'presents-distance' })\n  presentsDistance = 100;\n\n  @property({ type: 'Number', reflect: true, attribute: 'presents-interval' })\n  presentsInterval = 100;\n\n  @property({ type: 'Number', reflect: true, attribute: 'presents-drop-speed' })\n  presentsDropSpeed = 0.5;\n\n  debounceTimeStamp = 0;\n  rotate: 'clockwise' | 'counter-clockwise' = 'clockwise';\n\n  mouseX: number;\n  mouseY: number;\n  velocity = { x: 0, y: 0 };\n  velocityInterval: ReturnType<typeof setInterval>;\n  moveInterval: ReturnType<typeof setInterval>;\n  _rotation = 5;\n\n  connectedCallback() {\n    super.connectedCallback();\n    if (this.parentElement !== document.documentElement) {\n      document.documentElement.prepend(this);\n    } else {\n      this.init();\n    }\n  }\n\n  render() {\n    return html`\n      <img src=\"data:image/gif;base64,${santa}\" />\n    `;\n  }\n\n  get frameWidth() {\n    return document.documentElement.getBoundingClientRect().width;\n  }\n\n  get frameHeight() {\n    return document.documentElement.getBoundingClientRect().height;\n  }\n\n  get x() {\n    return parseFloat(\n      getComputedStyle(this).getPropertyValue('left').replace('px', '')\n    );\n  }\n\n  set x(value) {\n    this.style.setProperty('left', `${value}px`);\n\n    if (value > this.frameWidth - this.getBoundingClientRect().width) {\n      this.boundaryHit('right');\n    }\n\n    if (value < 0) {\n      this.boundaryHit('left');\n    }\n  }\n\n  get y() {\n    return parseFloat(\n      getComputedStyle(this).getPropertyValue('top').replace('px', '')\n    );\n  }\n\n  set y(value) {\n    this.style.setProperty('top', `${value}px`);\n\n    if (\n      value >\n      this.frameHeight - this.getBoundingClientRect().height\n    ) {\n      this.boundaryHit('bottom');\n    }\n\n    if (value < 0) {\n      this.boundaryHit('top');\n    }\n  }\n\n  get rotation() {\n    return this._rotation;\n  }\n\n  set rotation(value) {\n    this.style.setProperty('--santa-rotate', `${value}deg`);\n    this._rotation = value;\n  }\n\n  init() {\n    const xMiddle = this.frameWidth / 2;\n    const yMiddle = document.documentElement.clientHeight / 2;\n\n    this.x = xMiddle;\n    this.y = yMiddle;\n    this.randomizeVelocity();\n    this.startVelocityInterval();\n    requestAnimationFrame(() => {\n      this.move();\n    });\n\n    setInterval(() => {\n      this.debounceTimeStamp++;\n    });\n\n    document.documentElement.addEventListener('mousemove', (ev) => {\n      this.checkDistance({ x: ev.pageX, y: ev.pageY });\n    });\n  }\n\n  move() {\n    if (this.rotation > 25) {\n      this.rotate = 'counter-clockwise';\n    } else if (this.rotation < 5) {\n      this.rotate = 'clockwise';\n    }\n    this.rotation += this.rotate === 'clockwise' ? 0.1 : -0.1;\n    this.x = this.x + this.velocity.x * this.speed;\n    this.y = this.y + this.velocity.y * this.speed;\n    requestAnimationFrame(this.move.bind(this));\n  }\n\n  randomizeVelocity(forced: { x?: number, y?: number} = {}) {\n    const { x: _x, y: _y } = forced;\n    const x = _x || rangeMap(Math.random(), 0, 1, -1, 1);\n    const y = _y || rangeMap(Math.random(), 0, 1, -1, 1);\n    this.velocity = { x, y };\n    this.xDirection = x > 0 ? 'right' : 'left';\n  }\n\n  throwPresents() {\n    if (this.debounceTimeStamp > this.presentsInterval) { // debounce\n      this.throwPresent();\n      this.debounceTimeStamp = 0;\n    }\n  }\n\n  throwPresent() {\n    const el = document.createElement('santa-present') as SantaPresent;\n    const santaOffsetX = this.xDirection === 'left' ? 180 : 70;\n    const santaOffsetY = 80;\n    el.x = this.x + santaOffsetX;\n    el.y = this.y + santaOffsetY;\n    el.dropSpeed = this.presentsDropSpeed;\n    el.velocity = {\n      x: rangeMap(Math.random(), 0, 1, -2, 2),\n      y: rangeMap(Math.random(), 0, 1, -2, -7),\n    };\n    document.documentElement.prepend(el);\n  }\n\n  startVelocityInterval() {\n    this.velocityInterval = setInterval(() => this.randomizeVelocity(), this.changeSpeed);\n  }\n\n  boundaryHit(side) {\n    clearInterval(this.velocityInterval);\n\n    switch (side) {\n      case 'right':\n        this.randomizeVelocity({ x: rangeMap(Math.random(), 0, 1, -0.75, -1) });\n        break;\n      case 'left':\n        this.randomizeVelocity({ x: rangeMap(Math.random(), 0, 1, 0.75, 1) });\n        break;\n      case 'top':\n        this.randomizeVelocity({ y: rangeMap(Math.random(), 0, 1, 0.75, 1) });\n        break;\n      case 'bottom':\n        this.randomizeVelocity({ y: rangeMap(Math.random(), 0, 1, -0.75, -1) });\n        break;\n    }\n\n    this.startVelocityInterval();\n  }\n\n  checkDistance(coords: { x: number, y: number }) {\n    const xDistance = Math.abs(\n      this.x + this.getBoundingClientRect().width / 2 - coords.x\n    );\n    const yDistance = Math.abs(\n      this.y + this.getBoundingClientRect().height / 2 - coords.y\n    );\n\n    const distance = Math.sqrt(xDistance ** 2 + yDistance ** 2);\n\n    if (distance < this.presentsDistance) {\n      this.throwPresents();\n    }\n  }\n}\n\nexport const cleanup = (tagName = 'flying-santa') => {\n  Array.from(document.querySelectorAll(tagName)).forEach(santaEl => santaEl.remove());\n}\n"]}